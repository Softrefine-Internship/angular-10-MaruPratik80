<div class="search-bar">
  <!-- <mat-form-field>
    <mat-label>Search</mat-label>
    <input matInput placeholder="Search by tag" [(ngModel)]="searchTag" />
  </mat-form-field> -->
  <mat-form-field class="search" subscriptSizing="dynamic" appearance="outline">
    <mat-label>Serch by tag</mat-label>
    <mat-chip-grid #chipGrid aria-label="Enter tags">
      <mat-chip-row
        *ngFor="let tag of searchTags"
        (removed)="remove(tag)"
        [editable]="true"
        (edited)="edit(tag, $event)"
        [aria-description]="'press enter to edit ' + tag"
      >
        {{ tag }}
        <button matChipRemove [attr.aria-label]="'remove ' + tag">
          <mat-icon>cancel</mat-icon>
        </button>
      </mat-chip-row>
      <input
        placeholder="Enter tag..."
        [matChipInputFor]="chipGrid"
        [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
        [matChipInputAddOnBlur]="true"
        (matChipInputTokenEnd)="add($event)"
      />
    </mat-chip-grid>
  </mat-form-field>

  <button mat-raised-button color="primary" (click)="resetSearch()">Reset</button>

  <mat-form-field subscriptSizing="dynamic" appearance="outline" class="sort">
    <mat-label>Sort by</mat-label>
    <mat-select [(value)]="sortBy">
      <mat-option value="name">Name</mat-option>
      <mat-option value="uploadDate">Date</mat-option>
      <mat-option value="size">Size</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<div class="spinner" *ngIf="images.length === 0">
  <mat-spinner mode="indeterminate" color="accent" />
</div>

<div class="gallery">
  <mat-card *ngFor="let image of filteredImages" class="image-card">
    <img mat-card-image [src]="image.url" [alt]="image.name" (click)="openViewImageDialog(image)" />
    <div class="actions">
      <button mat-mini-fab color="warn" (click)="openDeleteDialog(image)"><mat-icon>delete</mat-icon></button>
    </div>
    <div class="tags">
      <button mat-icon-button (click)="openTagDialog(image)" class="btn-add-tag">
        <mat-icon>add_circle_outline</mat-icon>
      </button>
      <mat-chip-listbox class="tags-list">
        <mat-chip *ngFor="let tag of image.tags.slice(0, 2)" (click)="openTagDialog(image)" class="tag">
          <mat-icon matChipAvatar class="label">label</mat-icon>
          {{ tag }}
        </mat-chip>
        <mat-chip *ngIf="image.tags.length > 2" (click)="openTagDialog(image)">
          +{{ image.tags.length - 2 }}
        </mat-chip>
      </mat-chip-listbox>
    </div>
  </mat-card>
</div>
